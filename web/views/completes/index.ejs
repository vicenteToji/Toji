<%- include('../partials/header') %>
<%- include('../partials/navbar') %>

<main class="content">
    <div class="header-section">
        <h1>Historial de Entrenamientos</h1>
        <p>Tus sesiones completadas</p>
    </div>

    <div id="lista-entrenamientos">
        <p style="text-align:center; color:#666;">Cargando historial...</p>
    </div>
</main>

<script>
const API_URL = '/api/entrenamientos';

document.addEventListener('DOMContentLoaded', () => {
    cargarEntrenamientos();
});

async function cargarEntrenamientos() {
    const contenedor = document.getElementById('lista-entrenamientos');

    try {
        const response = await fetch(API_URL);
        if (!response.ok) throw new Error('Error al cargar');

        const entrenamientos = await response.json();

        contenedor.innerHTML = '';

        if (entrenamientos.length === 0) {
            contenedor.innerHTML = '<p style="text-align:center; color:#999;">No tienes entrenamientos a√∫n. <a href="/rutinas">Ve a rutinas</a></p>';
            return;
        }

        entrenamientos.forEach(ent => {
            const card = document.createElement('div');
            card.className = 'card-ejercicio';
            card.style.marginBottom = '20px';

            card.innerHTML = `
                <h3>Entrenamiento del ${new Date(ent.fecha).toLocaleDateString('es-ES')}</h3>
                <p><strong>Rutina:</strong> ${ent.rutina_nombre}</p>
                <p><strong>Series:</strong> ${ent.series_count}</p>
                <p><strong>Volumen total:</strong> ${ent.volumen_total} kg</p>
                ${ent.notas ? `<p><strong>Notas:</strong> ${ent.notas}</p>` : ''}
            `;

            contenedor.appendChild(card);
        });
    } catch (err) {
        contenedor.innerHTML = '<p style="color:red; text-align:center;">Error al cargar historial</p>';
    }
}
</script>

<%- include('../partials/footer') %>